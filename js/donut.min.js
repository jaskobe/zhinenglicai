/*! zhinenglicai 2016-04-11 */
var donut=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E={},F=$(window),G=!1,H=[2e3,5e3,5e3,5e3,5e3],I=[];return b=function(a){var b=$("#"+a).html()+$("#buttonsMarkup").html();$("#donut-container").html(b)},c=function(){var a=A.attr("data-segment"),b=Number(a)+1;b>=5&&(a=0,b=1),A.empty().append(I[a]).addClass("older-browsers-backup").attr("data-segment",b),u(H[1])},d=function(a){var b=0;for(b=0;4>b;b++)I[b]=new Image,I[b].src=a+"/a_stock_0"+b+".gif";u(H[1])},e=function(a,b){A.empty().append(a).addClass("older-browsers-backup").attr("data-segment","1"),d(b)},f=function(){var a=new Image,b=$("#older-browsers-backup").attr("src"),c=b.split("/");c.pop(),a.src=c.join("/")+"/a_stock_00.gif",a.alt="stocks",a.onLoad=e(a,c.join("/")),F.off("scroll.forDonut")},g=function(a,b){"segment-three"===b?(y.removeClass("segment-three").addClass("restart"),setTimeout(function(){y.removeClass("restart").addClass("loop animating").attr("data-state",a)},100),setTimeout(function(){y.addClass(a+" animating")},500)):y.removeClass(b+" loop").addClass(a+" animating").attr("data-state",a),h(y,b)},h=function(a,b){var c="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend";a.one(c,function(){a.removeClass("animating "+b),y.addClass("active")})},i=function(){y.toggleClass("active")},j=function(a,b){z.fadeOut(function(){"segment-zero"===b?z.addClass("intro"):z.removeClass("intro"),z.html(a).fadeIn()})},k=function(){var a=$("#donut").attr("data-state"),b="",c=["Sample<br />Portfolio<br /><span>Portfolios will have up to<br />20 asset classes</span>","Stocks","Fixed Income","Commodities","Cash"],d="",e=0,f=0;switch(a){case"segment-zero":b="segment-one",f=1;break;case"segment-one":b="segment-two",f=2;break;case"segment-two":b="segment-three",f=3;break;case"segment-three":b="segment-zero",f=0;break;case"segment-four":b="segment-zero",f=0}d=c[f],e=H[f],i(),g(b,a),j(d,b),u(e)},u=function(a){v=setTimeout(function(){G?k():c()},a)},l=function(){F.off("scroll.forDonut"),y.addClass("segment-one animating"),B.removeClass("initial-state"),h(y,""),j("stocks"),u(H[1]),D.fadeOut(function(){$("#play-pause").css({display:"none"}),D.fadeIn()})},m=function(){var a=y.hasClass("segment-one"),b="";return w=document.getElementById("donut-wrapper"),w=w.getBoundingClientRect(),b=w.top,80>=b&&!G?void f():void(80>=b&&!a&&G&&l())},n=function(a){a.preventDefault();var b=$(this),c=b.hasClass("pause"),d=b.hasClass("play");clearTimeout(v),b.fadeOut("fast",function(){return $("#play-pause").css({display:"none"}),c?void b.addClass("play").removeClass("pause").fadeIn(200).focus().attr("aria-label","Portfolio management animation paused"):void(d?(b.addClass("pause").removeClass("play").fadeIn(200).focus().attr("aria-label","Portfolio management animation playing"),u(100)):l())})},o=function(){F.on("scroll.forDonut",m)},p=function(){D.on("click",n)},q=function(){return window.getComputedStyle?window.getComputedStyle(document.body,":after").getPropertyValue("content").replace(/\"/g,""):"tablet"},r=function(a){x.attr("data-size")!==a&&x.attr("data-size",a).appendTo("mobile"===a?"#mobile-only":"#non-mobile")},s=function(){F.on("resize",function(){r(q())})},t=function(){x=$("#donut-wrapper"),y=$("#donut"),z=$("#stocks-text"),A=$("#backup-container"),B=$("#inner-ring"),C=$("#inner-ring-portions"),D=$("#donut-button")},E.init=function(){a?(b("cssTransitionDom"),t(),r(q()),s(),G=!0):(b("noCssTransitionDom"),t()),o(),p()},E}(Modernizr.csstransitions);$(donut.init);